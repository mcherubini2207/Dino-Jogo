<!DOCTYPE html>
<html>
<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>T-Rex Combat: Boss Edition</title>
    <style>
        body { text-align: center; font-family: 'Arial', sans-serif; background: #1a1a1a; color: white; margin: 0; overflow: hidden; touch-action: manipulation; }
        canvas { background: #2c3e50; border-bottom: 5px solid #27ae60; display: block; margin: 0 auto; width: 100%; max-width: 600px; height: auto; }
        .controls { display: grid; grid-template-columns: 1fr 1fr 1fr; gap: 10px; padding: 10px; max-width: 600px; margin: 0 auto; }
        button { padding: 15px 5px; font-size: 14px; border: none; border-radius: 8px; color: white; font-weight: bold; cursor: pointer; }
        .btn-jump { background: #3498db; grid-column: span 3; font-size: 20px; }
        .btn-1 { background: #e67e22; }
        .btn-2 { background: #f1c40f; color: black; }
        .btn-3 { background: #e74c3c; }
        .stats { font-size: 18px; margin: 10px; font-weight: bold; }
        #boss-warning { color: yellow; display: none; font-size: 24px; animation: blink 0.5s infinite; }
        @keyframes blink { 0% { opacity: 0; } 50% { opacity: 1; } }
    </style>
</head>
<body>
    <div class="stats">HP: <span id="hp" style="color: #2ecc71;">100</span> | Pontos: <span id="score">0</span></div>
    <div id="boss-warning">‚ö†Ô∏è CUIDADO: DRAG√ÉO MESTRE CHEGANDO! ‚ö†Ô∏è</div>
    <canvas id="gameCanvas" width="600" height="250"></canvas>
    
    <div class="controls">
        <button class="btn-jump" onclick="jump()">PULAR ‚¨ÜÔ∏è</button>
        <button class="btn-1" onclick="attack('mordida')">MORDIDA ü¶∑</button>
        <button class="btn-2" onclick="attack('rugido')">RUGIDO üì¢</button>
        <button class="btn-3" onclick="attack('rabada')">RABADA ü¶¥</button>
    </div>

    <script>
        const canvas = document.getElementById("gameCanvas");
        const ctx = canvas.getContext("2d");
        
        let hp = 100;
        let score = 0;
        let bossActive = false;
        let dino = { x: 50, y: 180, w: 50, h: 50, dy: 0, jump: -12, gravity: 0.7, grounded: true, action: "" };
        let enemies = [];
        let projectiles = [];
        let items = [];

        function jump() { if(dino.grounded) { dino.dy = dino.jump; dino.grounded = false; } }

        function attack(type) {
            dino.action = type;
            setTimeout(() => { dino.action = ""; }, 300);
            if(type === 'rugido') projectiles.push({x: dino.x + 40, y: dino.y + 10, speed: 8, type: 'wave'});
            
            enemies.forEach((en) => {
                let dist = Math.abs(en.x - dino.x);
                if(type === 'mordida' && dist < 80) en.hp -= 35;
                if(type === 'rabada' && dist < 110) en.hp -= 60;
            });
        }

        function update() {
            dino.dy += dino.gravity;
            dino.y += dino.dy;
            if (dino.y > 180) { dino.y = 180; dino.dy = 0; dino.grounded = true; }

            // Aparecer Bife (Cura)
            if (Math.random() < 0.005) items.push({ x: Math.random() * 500 + 50, y: -50, dy: 2 });

            // L√≥gica de Inimigos
            if (!bossActive && Math.random() < 0.01) {
                enemies.push({ x: 600, y: 180, hp: 100, shootTimer: 0, type: 'normal' });
            }

            // Boss Final aparece com 100 pontos
            if (score >= 100 && !bossActive) {
                bossActive = true;
                document.getElementById("boss-warning").style.display = "block";
                setTimeout(() => {
                    document.getElementById("boss-warning").style.display = "none";
                    enemies.push({ x: 600, y: 130, hp: 1000, shootTimer: 0, type: 'boss' });
                }, 3000);
            }

            // Atualizar Itens
            items.forEach((it, i) => {
                it.y += it.dy;
                if(Math.abs(it.x - dino.x) < 40 && Math.abs(it.y - dino.y) < 40) {
                    hp = Math.min(100, hp + 20);
                    items.splice(i, 1);
                }
            });

            // Tiros
            projectiles.forEach((p, pi) => {
                p.x += p.speed;
                enemies.forEach((en) => {
                    if(p.x > en.x && p.x < en.x + 60) { en.hp -= 20; projectiles.splice(pi, 1); }
                });
            });

            // Inimigos
            enemies.forEach((en, i) => {
                if(en.type === 'normal') en.x -= 2;
                else if(en.x > 400) en.x -= 1; // Boss para no meio

                en.shootTimer += (en.type === 'boss' ? 2 : 1);
                if(en.shootTimer > 80) {
                    projectiles.push({x: en.x, y: en.y + 20, speed: -6, type: 'fire'});
                    en.shootTimer = 0;
                }

                projectiles.forEach((p, pi) => {
                    if(p.type === 'fire' && p.x < dino.x + 40 && p.x > dino.x && p.y > dino.y && p.y < dino.y + 60) {
                        hp -= 5;
                        projectiles.splice(pi, 1);
                    }
                });

                if(en.hp <= 0) {
                    if(en.type === 'boss') alert("VOC√ä VENCEU O DRAG√ÉO MESTRE! üèÜ");
                    enemies.splice(i, 1); 
                    score += 20; 
                }
            });

            document.getElementById("hp").innerText = hp;
            document.getElementById("score").innerText = score;
            if(hp <= 0) { alert("Game Over!"); location.reload(); }
        }

        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            ctx.font = "50px Arial";
            ctx.fillText("ü¶ñ", dino.x, dino.y + 40);
            if(dino.action === 'mordida') ctx.fillText("üí•", dino.x + 45, dino.y + 20);
            if(dino.action === 'rabada') ctx.fillText("üå™Ô∏è", dino.x - 25, dino.y + 45);
            if(dino.action === 'rugido') ctx.fillText("üóØÔ∏è", dino.x + 45, dino.y + 15);

            items.forEach(it => ctx.fillText("üçñ", it.x, it.y));

            enemies.forEach(en => {
                let size = en.type === 'boss' ? "100px" : "50px";
                ctx.font = size + " Arial";
                ctx.fillText(en.type === 'boss' ? "üëë" : "üêâ", en.x, en.y + (en.type === 'boss' ? 80 : 40));
                ctx.fillStyle = "red";
                ctx.fillRect(en.x, en.y - 20, (en.hp / (en.type === 'boss' ? 10 : 1)), 8);
            });

            projectiles.forEach(p => ctx.fillText(p.type === 'fire' ? "üî•" : "üîµ", p.x, p.y + 20));
        }

        function loop() { update(); draw(); requestAnimationFrame(loop); }
        loop();
    </script>
</body>
</html>
